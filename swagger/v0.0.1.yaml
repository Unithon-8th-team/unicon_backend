openapi: 3.0.0
info:
  title: 화내줄께
  version: 0.0.1
servers:
  - url: http://localhost:3000
    description: Local server

components:
  securitySchemes:
    bearerAuth: # 이 이름과
      type: http
      scheme: bearer
      bearerFormat: JWT

tags:
  - name: Auth
    description: 로그인 및 인증 관련 API
  - name: Users
    description: 사용자 정보 관련 API
  - name: Chat
    description: AI 대화 API
  - name: Shop
    description: 상점 관련 API

paths:
  /auth/kakao:
    post:
      tags:
        - Auth
      summary: 카카오 로그인
      responses:
        '200':
          description: 로그인 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                    example: jwt.access.token
                  refreshToken:
                    type: string
                    example: jwt.refresh.token
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: '123'
                      email:
                        type: string
                        example: user@example.com
                      nickname:
                        type: string
                        example: 홍길동
                      coin:
                        type: integer
                        example: 30
                      dailyConversationCount:
                        type: integer
                        example: 0

  /users/inventory:
    get:
      tags:
        - Users
      summary: 내 인벤토리 조회
      security:
        - bearerAuth: []
      description: 사용자가 소유한 의상 목록을 반환합니다.
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: inv_789
                    itemId:
                      type: string
                      example: cloth_001
                    name:
                      type: string
                      example: 붉은 티셔츠
                    equipped:
                      type: boolean
                      example: false

  /users/profile:
    get:
      tags:
        - Users
      summary: 내 프로필 조회
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 프로필 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: '123'
                  profileImageUrl:
                    type: string
                    example: https://cdn.example.com/profiles/123/profile.png
                  email:
                    type: string
                    example: user@example.com
                  nickname:
                    type: string
                    example: 홍길동
                  coin:
                    type: integer
                    example: 30
                  dailyConversationCount:
                    type: integer
                    example: 0
    post:
      tags:
        - Users
      summary: 프로필 이미지 및 닉네임 변경
      description: 프로필 이미지를 업로드하고 닉네임을 함께 변경
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                  example: 새닉네임
                  description: 변경할 닉네임
                file:
                  type: string
                  format: binary
                  description: 업로드할 이미지 파일 (jpg, png 등)
      responses:
        '200':
          description: 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: '123'
                  profileImageUrl:
                    type: string
                    example: https://cdn.example.com/profiles/123/profile.png
                  email:
                    type: string
                    example: user@example.com
                  nickname:
                    type: string
                    example: 홍길동
                  coin:
                    type: integer
                    example: 30
                  dailyConversationCount:
                    type: integer
                    example: 0

  /users/avatar/clothes:
    post:
      tags:
        - Users
      summary: 캐릭터 의상 착용
      security:
        - bearerAuth: []
      description: 인벤토리의 아이템을 캐릭터에 착용시킵니다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                inventoryItemIds:
                  type: array
                  items:
                    type: string
                  example: ['inv_789', 'inv_456', 'inv_123']
      responses:
        '200':
          description: 착용 완료
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 착용 완료
                  equippedItem:
                    type: object
                    properties:
                      id:
                        type: string
                        example: inv_789
                      name:
                        type: string
                        example: 붉은 티셔츠

  /chat:
    post:
      tags:
        - Chat
      summary: AI 대화
      security:
        - bearerAuth: []
      description: >
        AI와 대화를 진행.  
        1일 최대 5회 무료 가능, 초과 시 코인 사용 또는 구매 필요.  
        무료 횟수를 다 사용하면 대화 종료 시 10코인 지급.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: 오늘 날씨 어때?
                level:
                  type: integer
                  example: 3
      responses:
        '200':
          description: 정상 대화 가능 시
          content:
            application/json:
              schema:
                type: object
                properties:
                  reply:
                    type: string
                    example: 오늘은 맑고 기온은 26도입니다.
                  remainingFreeChats:
                    type: integer
                    example: 3
        '429':
          description: 무료 횟수 초과
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: FREE_CHAT_LIMIT_EXCEEDED
                  message:
                    type: string
                    example: 오늘의 무료 대화 횟수를 모두 사용했습니다. 코인을 사용하거나 구매해주세요.

  /shop/items:
    get:
      tags:
        - Shop
      summary: 상점 아이템 목록 조회
      security:
        - bearerAuth: []
      description: 상점에 진열된 의상 목록을 가져옵니다.
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: cloth_001
                    name:
                      type: string
                      example: 붉은 티셔츠
                    priceCoin:
                      type: integer
                      example: 50
                    imageUrl:
                      type: string
                      example: https://cdn.example.com/clothes/red_tshirt.png

  /shop/purchase:
    post:
      tags:
        - Shop
      summary: 아이템 구매
      description: 사용자의 코인을 차감하고 인벤토리에 아이템을 추가합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                itemId:
                  type: string
                  example: cloth_001
                  description: 구매하려는 아이템 ID
      responses:
        '200':
          description: 구매 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 구매 완료되었습니다.
                  coin:
                    type: integer
                    example: 20
                    description: 구매 후 남은 코인 잔액
                  inventoryItemId:
                    type: string
                    example: inv_789
                    description: 새로 추가된 인벤토리 아이템 ID
        '400':
          description: 구매 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: INSUFFICIENT_COIN
                  message:
                    type: string
                    example: 코인이 부족합니다.
        '401':
          description: 인증 실패
        '404':
          description: 아이템을 찾을 수 없음
